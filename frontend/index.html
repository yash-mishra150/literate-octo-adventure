<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Feedback</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <div class="card">
    <h2>We‚Äôd Love Your Feedback üí¨</h2>

    <input id="name" type="text" placeholder="Your Name *" />
    <input id="email" type="email" placeholder="Email (optional)" />

    <select id="rating">
      <option value="">Rating</option>
      <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
      <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê</option>
      <option value="3">‚≠ê‚≠ê‚≠ê</option>
      <option value="2">‚≠ê‚≠ê</option>
      <option value="1">‚≠ê</option>
    </select>

    <textarea id="message" placeholder="Your feedback *"></textarea>

    <button onclick="submitFeedback()">Send Feedback</button>

    <div id="feedbackList" class="feedback-list"></div>
  </div>

  <p class="note">
    Your feedback helps us improve and build better experiences.
  </p>

  <iframe
    class="map"
    src="https://www.google.com/maps?q=India&output=embed"
    loading="lazy">
  </iframe>

<script>
async function submitFeedback() {
  const payload = {
    name: document.getElementById("name").value.trim(),
    email: document.getElementById("email").value.trim(),
    rating: document.getElementById("rating").value,
    message: document.getElementById("message").value.trim()
  };

  if (!payload.name || !payload.message) {
    alert("Name and message are required");
    return;
  }

  const res = await fetch("/api/feedback", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  });

  if (res.ok) {
    document.getElementById("name").value = "";
    document.getElementById("email").value = "";
    document.getElementById("rating").value = "";
    document.getElementById("message").value = "";
    loadFeedback();
  } else {
    alert("Something went wrong. Please try again.");
  }
}

async function loadFeedback() {
  const res = await fetch("/api/feedback");
  const data = await res.json();

  const list = document.getElementById("feedbackList");
  list.innerHTML = data.map(f => `
    <div class="feedback-item">
      <div class="feedback-header">
        <strong>${f.name}</strong>
        ${f.rating ? `<span>‚≠ê${f.rating}</span>` : ""}
      </div>
      <p>${f.message}</p>
      <small>${new Date(f.created_at).toLocaleString()}</small>
    </div>
  `).join("");
}

loadFeedback();
</script>

</body>
</html>

